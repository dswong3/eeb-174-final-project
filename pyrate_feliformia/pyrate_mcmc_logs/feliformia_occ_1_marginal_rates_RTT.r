# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/eeb-174-final-project/pyrate_feliformia/pyrate_mcmc_logs/feliformia_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/eeb-174-final-project/pyrate_feliformia/pyrate_mcmc_logs/feliformia_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.172593365495, 0.172593365495,0.172593365495,0.172593365495,0.172593365495,0.172593365495,0.172593365495,0.173157427596,0.173157427596,0.173157427596,0.173157427596,0.173157427596,0.173157427596,0.173157427596,0.173157427596,0.173157427596,0.173157427596,0.173157427596,0.173157427596,0.173157427596,0.17139446065,0.173157427596,0.17139446065,0.17139446065,0.173157427596,0.173157427596,0.173157427596,0.173157427596,0.172593365495,0.174006411571,0.174006411571,0.173157427596,0.17043556829,0.164278661503,0.159458070102,0.16655709046,0.162470278255,0.159458070102,0.16655709046,0.172844774714,0.172593365495,0.172593365495,0.172593365495,0.16655709046,0.16655709046,0.16655709046,0.16655709046,0.16655709046,0.162470278255,0.163321224787,0.166735915671,0.163321224787,0.163321224787,0.163321224787,0.163321224787,0.163321224787,0.163321224787,0.163321224787,0.163321224787,0.162470278255,0.162470278255)
L_hpd_M95=c(0.224315376603, 0.224315376603,0.224315376603,0.224315376603,0.224315376603,0.224315376603,0.224315376603,0.224523364051,0.224523364051,0.224523364051,0.224523364051,0.224523364051,0.224837730886,0.224837730886,0.224837730886,0.224837730886,0.224837730886,0.225043639379,0.225043639379,0.225043639379,0.225043639379,0.227051484678,0.225043639379,0.225043639379,0.227051484678,0.227051484678,0.227051484678,0.227051484678,0.226907009813,0.228902611429,0.228957792285,0.230070601558,0.232184438478,0.234742732888,0.280493858785,0.291320483377,0.323190943315,0.333724711286,0.345726470037,0.354424728537,0.354424728537,0.356169335055,0.357405583077,0.354424728537,0.354963553775,0.354424728537,0.354963553775,0.356169335055,0.357828023882,0.365617705615,0.377124627722,0.377124627722,0.377124627722,0.377124627722,0.377124627722,0.377124627722,0.377124627722,0.377124627722,0.377124627722,0.377124627722,0.377124627722)
M_hpd_m95=c(0.54431228978, 0.54431228978,0.0941391307708,0.0944298157747,0.0944298157747,0.0941391307708,0.0944298157747,0.0941391307708,0.0934403668712,0.0927623915287,0.0922561603847,0.0934403668712,0.0934403668712,0.0941391307708,0.095981254458,0.0944298157747,0.0945907654573,0.094782287636,0.0945907654573,0.0945907654573,0.0944298157747,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381,0.0961833070381)
M_hpd_M95=c(0.93382000634, 0.93382000634,0.141050392683,0.141565532737,0.141565532737,0.141050392683,0.141565532737,0.141565532737,0.141565532737,0.141565532737,0.141920601837,0.142796383976,0.142796383976,0.144094203455,0.145673789287,0.144632404783,0.145673789287,0.145673789287,0.145673789287,0.145673789287,0.145673789287,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725,0.147998808725)
R_hpd_m95=c(-0.728469545987, -0.728469545987,0.0456081656136,0.0456081656136,0.0456081656136,0.0454347334467,0.0454347334467,0.049201714344,0.049201714344,0.049201714344,0.0456081656136,0.0454347334467,0.0454347334467,0.0442399786478,0.0442399786478,0.0434814737338,0.0422129081437,0.0411421684122,0.0411421684122,0.040000240105,0.040000240105,0.040000240105,0.0401651708635,0.0401651708635,0.0401651708635,0.040000240105,0.040000240105,0.040000240105,0.036266889572,0.036266889572,0.0351224396883,0.040000240105,0.029007837734,0.0228630909155,0.00780292908082,0.0228630909155,0.0228630909155,0.0188134422856,0.029007837734,0.029007837734,0.0246678519465,0.0228630909155,0.0228630909155,0.0188134422856,0.0155556949953,0.0188134422856,0.0155556949953,0.029007837734,0.0232864964033,0.0228630909155,0.0155556949953,0.00668533831443,0.00668533831443,0.00668533831443,0.00668533831443,0.00668533831443,0.00668533831443,0.00668533831443,0.00668533831443,0.00771826343529,0.00771826343529)
R_hpd_M95=c(-0.342345242024, -0.342345242024,0.11625173711,0.11625173711,0.11625173711,0.115758130431,0.115758130431,0.119534159482,0.119534159482,0.119534159482,0.11625173711,0.115758130431,0.115758130431,0.113908799576,0.113908799576,0.114110491635,0.114110491635,0.113585918167,0.114110491635,0.113585918167,0.115609076845,0.11625173711,0.11625173711,0.11625173711,0.11625173711,0.115609076845,0.116159056776,0.116159056776,0.113585918167,0.114110491635,0.114110491635,0.124165908832,0.121659168517,0.125619206477,0.158482677688,0.178447815581,0.214959965927,0.224103441561,0.241321193587,0.243358177975,0.241321193587,0.24082151537,0.241321193587,0.243358177975,0.243358177975,0.243358177975,0.243358177975,0.258228033751,0.2577083186,0.258228033751,0.259425942153,0.255056457012,0.255056457012,0.255056457012,0.255056457012,0.255056457012,0.255056457012,0.255056457012,0.255056457012,0.2577083186,0.2577083186)
L_mean=c(0.198826305258, 0.198826305258,0.198826305258,0.198826305258,0.198826305258,0.198809075629,0.198809075629,0.198764215412,0.198748401511,0.198734642539,0.198734642539,0.198719065416,0.198753797479,0.198786980998,0.198774504944,0.198765987882,0.198781600578,0.198802308247,0.198780414306,0.198822554299,0.199007154733,0.199024078978,0.199019380576,0.198974207766,0.199049018839,0.199064147381,0.199152679981,0.199192103898,0.199407518253,0.199461998664,0.199547265418,0.200443466503,0.202561962927,0.204468641722,0.208394846966,0.209072668089,0.213348485322,0.215336355436,0.216783592126,0.217005886902,0.217272081495,0.217089174331,0.217712794535,0.217491604983,0.217761071395,0.21751987291,0.217921370357,0.218364261949,0.218756838331,0.219848284222,0.221589880301,0.222673678008,0.222673678008,0.222673678008,0.222673678008,0.222673678008,0.222673678008,0.222673678008,0.222673678008,0.223219947073,0.223219947073)
M_mean=c(0.725108056567, 0.725108056567,0.117016834495,0.117000417377,0.117000417377,0.117049707648,0.117035856368,0.116976952096,0.116957561193,0.116884317647,0.117215465523,0.117524758783,0.117775035629,0.119062950035,0.119705735679,0.120082087079,0.120515720974,0.120673213479,0.121083816814,0.121449938693,0.121604274463,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199,0.121634287199)
R_mean=c(-0.52628175131, -0.52628175131,0.0818094707623,0.0818258878806,0.0818258878806,0.0817593679813,0.0817732192616,0.0817872633159,0.0817908403177,0.0818503248919,0.0815191770165,0.0811943066327,0.0809787618502,0.0797240309635,0.0790687692649,0.0786839008028,0.0782658796033,0.0781290947678,0.077696597492,0.0773726156062,0.0774028802705,0.0773897917784,0.0773850933769,0.0773399205662,0.0774147316396,0.0774298601818,0.0775183927812,0.0775578166982,0.077773231054,0.0778277114647,0.0779129782187,0.0788091793039,0.0809276757279,0.0828343545224,0.0867605597666,0.0874383808896,0.0917141981229,0.0937020682368,0.0951493049265,0.0953715997022,0.095637794296,0.0954548871319,0.096078507336,0.0958573177839,0.0961267841955,0.0958855857101,0.0962870831581,0.0967299747498,0.0971225511312,0.0982139970224,0.0999555931011,0.101039390808,0.101039390808,0.101039390808,0.101039390808,0.101039390808,0.101039390808,0.101039390808,0.101039390808,0.101585659874,0.101585659874)
trans=0.5
age=(0:(61-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.414837090495), xlim = c(-64.05,3.05), ylab = 'Speciation rate', xlab = 'Ma',main='feliformia' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.02720200697), xlim = c(-64.05,3.05), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-0.801316500585, 0.285368536368), xlim = c(-64.05,3.05), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-64.05,3.05), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()